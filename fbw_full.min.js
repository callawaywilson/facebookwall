(function(){var t=this,e=t._,n={},i=Array.prototype,s=Object.prototype,r=Function.prototype,o=i.push,a=i.slice,u=i.concat,c=s.toString,l=s.hasOwnProperty,h=i.forEach,f=i.map,d=i.reduce,m=i.reduceRight,p=i.filter,g=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,w=Array.isArray,_=Object.keys,k=r.bind,x=function(t){return t instanceof x?t:this instanceof x?void(this._wrapped=t):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.4.4";var M=x.each=x.forEach=function(t,e,i){if(null!=t)if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var s=0,r=t.length;r>s;s++)if(e.call(i,t[s],s,t)===n)return}else for(var o in t)if(x.has(t,o)&&e.call(i,t[o],o,t)===n)return};x.map=x.collect=function(t,e,n){var i=[];return null==t?i:f&&t.map===f?t.map(e,n):(M(t,function(t,s,r){i[i.length]=e.call(n,t,s,r)}),i)};var D="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,n,i){var s=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=x.bind(e,i)),s?t.reduce(e,n):t.reduce(e);if(M(t,function(t,r,o){s?n=e.call(i,n,t,r,o):(n=t,s=!0)}),!s)throw new TypeError(D);return n},x.reduceRight=x.foldr=function(t,e,n,i){var s=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return i&&(e=x.bind(e,i)),s?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var o=x.keys(t);r=o.length}if(M(t,function(a,u,c){u=o?o[--r]:--r,s?n=e.call(i,n,t[u],u,c):(n=t[u],s=!0)}),!s)throw new TypeError(D);return n},x.find=x.detect=function(t,e,n){var i;return T(t,function(t,s,r){return e.call(n,t,s,r)?(i=t,!0):void 0}),i},x.filter=x.select=function(t,e,n){var i=[];return null==t?i:p&&t.filter===p?t.filter(e,n):(M(t,function(t,s,r){e.call(n,t,s,r)&&(i[i.length]=t)}),i)},x.reject=function(t,e,n){return x.filter(t,function(t,i,s){return!e.call(n,t,i,s)},n)},x.every=x.all=function(t,e,i){e||(e=x.identity);var s=!0;return null==t?s:g&&t.every===g?t.every(e,i):(M(t,function(t,r,o){return(s=s&&e.call(i,t,r,o))?void 0:n}),!!s)};var T=x.some=x.any=function(t,e,i){e||(e=x.identity);var s=!1;return null==t?s:v&&t.some===v?t.some(e,i):(M(t,function(t,r,o){return s||(s=e.call(i,t,r,o))?n:void 0}),!!s)};x.contains=x.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},x.invoke=function(t,e){var n=a.call(arguments,2),i=x.isFunction(e);return x.map(t,function(t){return(i?e:t[e]).apply(t,n)})},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.where=function(t,e,n){return x.isEmpty(e)?n?null:[]:x[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},x.findWhere=function(t,e){return x.where(t,e,!0)},x.max=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&x.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return M(t,function(t,s,r){var o=e?e.call(n,t,s,r):t;o>=i.computed&&(i={value:t,computed:o})}),i.value},x.min=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&x.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return M(t,function(t,s,r){var o=e?e.call(n,t,s,r):t;o<i.computed&&(i={value:t,computed:o})}),i.value},x.shuffle=function(t){var e,n=0,i=[];return M(t,function(t){e=x.random(n++),i[n-1]=i[e],i[e]=t}),i};var F=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(t,e,n){var i=F(e);return x.pluck(x.map(t,function(t,e,s){return{value:t,index:e,criteria:i.call(n,t,e,s)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")};var C=function(t,e,n,i){var s={},r=F(e||x.identity);return M(t,function(e,o){var a=r.call(n,e,o,t);i(s,a,e)}),s};x.groupBy=function(t,e,n){return C(t,e,n,function(t,e,n){(x.has(t,e)?t[e]:t[e]=[]).push(n)})},x.countBy=function(t,e,n){return C(t,e,n,function(t,e){x.has(t,e)||(t[e]=0),t[e]++})},x.sortedIndex=function(t,e,n,i){n=null==n?x.identity:F(n);for(var s=n.call(i,e),r=0,o=t.length;o>r;){var a=r+o>>>1;n.call(i,t[a])<s?r=a+1:o=a}return r},x.toArray=function(t){return t?x.isArray(t)?a.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:a.call(t,0,e)},x.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},x.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var S=function(t,e,n){return M(t,function(t){x.isArray(t)?e?o.apply(n,t):S(t,e,n):n.push(t)}),n};x.flatten=function(t,e){return S(t,e,[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.uniq=x.unique=function(t,e,n,i){x.isFunction(e)&&(i=n,n=e,e=!1);var s=n?x.map(t,n,i):t,r=[],o=[];return M(s,function(n,i){(e?i&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),r.push(t[i]))}),r},x.union=function(){return x.uniq(u.apply(i,arguments))},x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})},x.difference=function(t){var e=u.apply(i,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=a.call(arguments),e=x.max(x.pluck(t,"length")),n=new Array(e),i=0;e>i;i++)n[i]=x.pluck(t,""+i);return n},x.object=function(t,e){if(null==t)return{};for(var n={},i=0,s=t.length;s>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},x.indexOf=function(t,e,n){if(null==t)return-1;var i=0,s=t.length;if(n){if("number"!=typeof n)return i=x.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,s+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;s>i;i++)if(t[i]===e)return i;return-1},x.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(b&&t.lastIndexOf===b)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var s=i?n:t.length;s--;)if(t[s]===e)return s;return-1},x.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),s=0,r=new Array(i);i>s;)r[s++]=t,t+=n;return r},x.bind=function(t,e){if(t.bind===k&&k)return k.apply(t,a.call(arguments,1));var n=a.call(arguments,2);return function(){return t.apply(e,n.concat(a.call(arguments)))}},x.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},x.bindAll=function(t){var e=a.call(arguments,1);return 0===e.length&&(e=x.functions(t)),M(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var n={};return e||(e=x.identity),function(){var i=e.apply(this,arguments);return x.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},x.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e){var n,i,s,r,o=0,a=function(){o=new Date,s=null,r=t.apply(n,i)};return function(){var u=new Date,c=e-(u-o);return n=this,i=arguments,0>=c?(clearTimeout(s),s=null,o=u,r=t.apply(n,i)):s||(s=setTimeout(a,c)),r}},x.debounce=function(t,e,n){var i,s;return function(){var r=this,o=arguments,a=function(){i=null,n||(s=t.apply(r,o))},u=n&&!i;return clearTimeout(i),i=setTimeout(a,e),u&&(s=t.apply(r,o)),s}},x.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return function(){var n=[t];return o.apply(n,arguments),e.apply(this,n)}},x.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},x.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},x.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)x.has(t,n)&&(e[e.length]=n);return e},x.values=function(t){var e=[];for(var n in t)x.has(t,n)&&e.push(t[n]);return e},x.pairs=function(t){var e=[];for(var n in t)x.has(t,n)&&e.push([n,t[n]]);return e},x.invert=function(t){var e={};for(var n in t)x.has(t,n)&&(e[t[n]]=n);return e},x.functions=x.methods=function(t){var e=[];for(var n in t)x.isFunction(t[n])&&e.push(n);return e.sort()},x.extend=function(t){return M(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},x.pick=function(t){var e={},n=u.apply(i,a.call(arguments,1));return M(n,function(n){n in t&&(e[n]=t[n])}),e},x.omit=function(t){var e={},n=u.apply(i,a.call(arguments,1));for(var s in t)x.contains(n,s)||(e[s]=t[s]);return e},x.defaults=function(t){return M(a.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var $=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var s=c.call(t);if(s!=c.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;n.push(t),i.push(e);var o=0,a=!0;if("[object Array]"==s){if(o=t.length,a=o==e.length)for(;o--&&(a=$(t[o],e[o],n,i)););}else{var u=t.constructor,l=e.constructor;if(u!==l&&!(x.isFunction(u)&&u instanceof u&&x.isFunction(l)&&l instanceof l))return!1;for(var h in t)if(x.has(t,h)&&(o++,!(a=x.has(e,h)&&$(t[h],e[h],n,i))))break;if(a){for(h in e)if(x.has(e,h)&&!o--)break;a=!o}}return n.pop(),i.pop(),a};x.isEqual=function(t,e){return $(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=w||function(t){return"[object Array]"==c.call(t)},x.isObject=function(t){return t===Object(t)},M(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return l.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.times=function(t,e,n){for(var i=Array(t),s=0;t>s;s++)i[s]=e.call(n,s);return i},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};L.unescape=x.invert(L.escape);var E={escape:new RegExp("["+x.keys(L.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(L.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(E[t],function(e){return L[t][e]})}}),x.result=function(t,e){if(null==t)return null;var n=t[e];return x.isFunction(n)?n.call(t):n},x.mixin=function(t){M(x.functions(t),function(e){var n=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),O.call(this,n.apply(x,t))}})};var A=0;x.uniqueId=function(t){var e=++A+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,Y={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,n){var i;n=x.defaults({},n,x.templateSettings);var s=new RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(s,function(e,n,i,s,a){return o+=t.slice(r,a).replace(P,function(t){return"\\"+Y[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),r=a+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return i(e,x);var u=function(t){return i.call(this,t,x)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},x.chain=function(t){return x(t).chain()};var O=function(t){return this._chain?x(t).chain():t};x.mixin(x),M(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];x.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],O.call(this,n)}}),M(["concat","join","slice"],function(t){var e=i[t];x.prototype[t]=function(){return O.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var t,e=this,n=e.Backbone,i=[],s=i.push,r=i.slice,o=i.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.10";var a=e._;a||"undefined"==typeof require||(a=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n)for(var s in n)t[e].apply(t,[s,n[s]].concat(i));else{if(!u.test(n))return!0;for(var r=n.split(u),o=0,a=r.length;a>o;o++)t[e].apply(t,[r[o]].concat(i))}},l=function(t,e){var n,i=-1,s=t.length;switch(e.length){case 0:for(;++i<s;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=t[i]).callback.call(n.ctx,e[0]);return;case 2:for(;++i<s;)(n=t[i]).callback.call(n.ctx,e[0],e[1]);return;case 3:for(;++i<s;)(n=t[i]).callback.call(n.ctx,e[0],e[1],e[2]);return;default:for(;++i<s;)(n=t[i]).callback.apply(n.ctx,e)}},h=t.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var i=this,s=a.once(function(){i.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,n),this},off:function(t,e,n){var i,s,r,o,u,l,h,f;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(o=t?[t]:a.keys(this._events),u=0,l=o.length;l>u;u++)if(t=o[u],i=this._events[t]){if(r=[],e||n)for(h=0,f=i.length;f>h;h++)s=i[h],(e&&e!==s.callback&&e!==s.callback._callback||n&&n!==s.context)&&r.push(s);this._events[t]=r}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&l(n,e),i&&l(i,arguments),this},listenTo:function(t,e,n){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=a.uniqueId("l"));return i[s]=t,t.on(e,"object"==typeof e?this:n,this),this},stopListening:function(t,e,n){var i=this._listeners;if(i){if(t)t.off(e,"object"==typeof e?this:n,this),e||n||delete i[t._listenerId];else{"object"==typeof e&&(n=this);for(var s in i)i[s].off(e,n,this);this._listeners={}}return this}}};h.bind=h.on,h.unbind=h.off,a.extend(t,h);var f=t.Model=function(t,e){var n,i=t||{};this.cid=a.uniqueId("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),(n=a.result(this,"defaults"))&&(i=a.defaults({},i,n)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};a.extend(f.prototype,h,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return a.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,s,r,o,u,c,l,h;if(null==t)return this;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;r=n.unset,u=n.silent,o=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=a.clone(this.attributes),this.changed={}),h=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)e=s[i],a.isEqual(h[i],e)||o.push(i),a.isEqual(l[i],e)?delete this.changed[i]:this.changed[i]=e,r?delete h[i]:h[i]=e;if(!u){o.length&&(this._pending=!0);for(var f=0,d=o.length;d>f;f++)this.trigger("change:"+o[f],this,h[o[f]],n)}if(c)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,a.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,a.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!a.isEmpty(this.changed):a.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?a.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in t)a.isEqual(i[s],e=t[s])||((n||(n={}))[s]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,n,i){return t.set(t.parse(n,i),i)?void(e&&e(t,n,i)):!1},this.sync("read",this,t)},save:function(t,e,n){var i,s,r,o,u=this.attributes;return null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,!i||n&&n.wait||this.set(i,n)?(n=a.extend({validate:!0},n),this._validate(i,n)?(i&&n.wait&&(this.attributes=a.extend({},u,i)),void 0===n.parse&&(n.parse=!0),s=n.success,n.success=function(t,e,n){t.attributes=u;var r=t.parse(e,n);return n.wait&&(r=a.extend(i||{},r)),a.isObject(r)&&!t.set(r,n)?!1:void(s&&s(t,e,n))},r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),o=this.sync(r,this,n),i&&n.wait&&(this.attributes=u),o):!1):!1},destroy:function(t){t=t?a.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(t,e,s){(s.wait||t.isNew())&&i(),n&&n(t,e,s)},this.isNew())return t.success(this,null,t),!1;var s=this.sync("delete",this,t);return t.wait||i(),s},url:function(){var t=a.result(this,"urlRoot")||a.result(this.collection,"url")||L();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return!this.validate||!this.validate(this.attributes,t)},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=a.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,e||{}),!1):!0}});var d=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,a.extend({silent:!0},e))};a.extend(d.prototype,h,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){t=a.isArray(t)?t.slice():[t],e||(e={});var n,i,r,u,c,l,h,f,d,m;for(h=[],f=e.at,d=this.comparator&&null==f&&0!=e.sort,m=a.isString(this.comparator)?this.comparator:null,n=0,i=t.length;i>n;n++)(r=this._prepareModel(u=t[n],e))?(c=this.get(r))?e.merge&&(c.set(u===r?r.attributes:u,e),d&&!l&&c.hasChanged(m)&&(l=!0)):(h.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)):this.trigger("invalid",this,u,e);if(h.length&&(d&&(l=!0),this.length+=h.length,null!=f?o.apply(this.models,[f,0].concat(h)):s.apply(this.models,h)),l&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=h.length;i>n;n++)(r=h[n]).trigger("add",r,this,e);return l&&this.trigger("sort",this,e),this},remove:function(t,e){t=a.isArray(t)?t.slice():[t],e||(e={});var n,i,s,r;for(n=0,i=t.length;i>n;n++)r=this.get(t[n]),r&&(delete this._byId[r.id],delete this._byId[r.cid],s=this.indexOf(r),this.models.splice(s,1),this.length--,e.silent||(e.index=s,r.trigger("remove",r,this,e)),this._removeReference(r));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,a.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,a.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[t.id||t.cid||t[this._idAttr]||t])},at:function(t){return this.models[t]},where:function(t){return a.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return a.invoke(this.models,"get",t)},update:function(t,e){e=a.extend({add:!0,merge:!0,remove:!0},e),e.parse&&(t=this.parse(t,e));var n,i,s,r,o=[],u=[],c={};if(a.isArray(t)||(t=t?[t]:[]),e.add&&!e.remove)return this.add(t,e);for(i=0,s=t.length;s>i;i++)n=t[i],r=this.get(n),e.remove&&r&&(c[r.cid]=!0),(e.add&&!r||e.merge&&r)&&o.push(n);if(e.remove)for(i=0,s=this.models.length;s>i;i++)n=this.models[i],c[n.cid]||u.push(n);return u.length&&this.remove(u,e),o.length&&this.add(o,e),this},reset:function(t,e){e||(e={}),e.parse&&(t=this.parse(t,e));for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models.slice(),this._reset(),t&&this.add(t,a.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,n,i){var s=i.update?"update":"reset";t[s](n,i),e&&e(t,n,i)},this.sync("read",this,t)},create:function(t,e){if(e=e?a.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(t,e,s){s.wait&&n.add(t,s),i&&i(t,e,s)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:!1},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))},sortedIndex:function(t,e,n){e||(e=this.comparator);var i=a.isFunction(e)?e:function(t){return t.get(e)};return a.sortedIndex(this.models,t,i,n)}});var m=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(m,function(t){d.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.models),a[t].apply(a,e)}});var p=["groupBy","countBy","sortBy"];a.each(p,function(t){d.prototype[t]=function(e,n){var i=a.isFunction(e)?e:function(t){return t.get(e)};return a[t](this.models,i,n)}});var g=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},v=/\((.*?)\)/g,y=/(\(\?)?:\w+/g,b=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(g.prototype,h,{initialize:function(){},route:function(e,n,i){return a.isRegExp(e)||(e=this._routeToRegExp(e)),i||(i=this[n]),t.history.route(e,a.bind(function(s){var r=this._extractParameters(e,s);i&&i.apply(this,r),this.trigger.apply(this,["route:"+n].concat(r)),this.trigger("route",n,r),t.history.trigger("route",this,n,r)},this)),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes)for(var t,e=a.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])},_routeToRegExp:function(t){return t=t.replace(w,"\\$&").replace(v,"(?:$1)?").replace(y,function(t,e){return e?t:"([^/]+)"}).replace(b,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var _=t.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,x=/^\/+|\/+$/g,M=/msie [\w.]+/,D=/\/$/;_.started=!1,a.extend(_.prototype,h,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(D,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(k,"")},start:function(e){if(_.started)throw new Error("Backbone.history has already been started");_.started=!0,this.options=a.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,s=M.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(x,"/"),s&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var r=this.location,o=r.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&r.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),_.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=a.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!_.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),t.history=new _;var T=t.View=function(t){this.cid=a.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},F=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];a.extend(T.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=a.result(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(a.isFunction(n)||(n=this[t[e]]),!n)throw new Error('Method "'+t[e]+'" does not exist');var i=e.match(F),s=i[1],r=i[2];n=a.bind(n,this),s+=".delegateEvents"+this.cid,""===r?this.$el.on(s,n):this.$el.on(s,r,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=a.extend({},a.result(this,"options"),t)),a.extend(this,a.pick(t,C)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(a.result(this,"el"),!1);else{var e=a.extend({},a.result(this,"attributes"));this.id&&(e.id=a.result(this,"id")),this.className&&(e["class"]=a.result(this,"className"));var n=t.$("<"+a.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}});var S={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.sync=function(e,n,i){var s=S[e];a.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:s,dataType:"json"};if(i.url||(r.url=a.result(n,"url")||L()),null!=i.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),i.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){r.type="POST",i.emulateJSON&&(r.data._method=s);var o=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),o?o.apply(this,arguments):void 0}}"GET"===r.type||i.emulateJSON||(r.processData=!1);var u=i.success;i.success=function(t){u&&u(n,t,i),n.trigger("sync",n,t,i)};var c=i.error;i.error=function(t){c&&c(n,t,i),n.trigger("error",n,t,i)};var l=i.xhr=t.ajax(a.extend(r,i));return n.trigger("request",n,l,i),l},t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var $=function(t,e){var n,i=this;n=t&&a.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},a.extend(n,i,e);var s=function(){this.constructor=n};return s.prototype=i.prototype,n.prototype=new s,t&&a.extend(n.prototype,t),n.__super__=i.prototype,n};f.extend=d.extend=g.extend=T.extend=_.extend=$;var L=function(){throw new Error('A "url" property or function must be specified')}}.call(this),function(t){function e(t,e,n,i){var s=n.lang();return s[t].call?s[t](n,i):s[t][e]}function n(t,e){return function(n){return a(t.call(this,n),e)}}function i(t){return function(e){var n=t.call(this,e);return n+this.lang().ordinal(n)}}function s(t,e,n){this._d=t,this._isUTC=!!e,this._a=t._a||null,this._lang=n||!1}function r(t){var e=this._data={},n=t.years||t.y||0,i=t.months||t.M||0,s=t.weeks||t.w||0,r=t.days||t.d||0,a=t.hours||t.h||0,u=t.minutes||t.m||0,c=t.seconds||t.s||0,l=t.milliseconds||t.ms||0;this._milliseconds=l+1e3*c+6e4*u+36e5*a,this._days=r+7*s,this._months=i+12*n,e.milliseconds=l%1e3,c+=o(l/1e3),e.seconds=c%60,u+=o(c/60),e.minutes=u%60,a+=o(u/60),e.hours=a%24,r+=o(a/24),r+=7*s,e.days=r%30,i+=o(r/30),e.months=i%12,n+=o(i/12),e.years=n,this._lang=!1}function o(t){return 0>t?Math.ceil(t):Math.floor(t)}function a(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}function u(t,e,n){var i,s=e._milliseconds,r=e._days,o=e._months;s&&t._d.setTime(+t+s*n),r&&t.date(t.date()+r*n),o&&(i=t.date(),t.date(1).month(t.month()+o*n).date(Math.min(i,t.daysInMonth())))}function c(t){return"[object Array]"===Object.prototype.toString.call(t)
}function l(t,e){var n,i=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),r=0;for(n=0;i>n;n++)~~t[n]!==~~e[n]&&r++;return r+s}function h(t,e,n,i){var s,r,o=[];for(s=0;7>s;s++)o[s]=t[s]=null==t[s]?2===s?1:0:t[s];return t[7]=o[7]=e,null!=t[8]&&(o[8]=t[8]),t[3]+=n||0,t[4]+=i||0,r=new Date(0),e?(r.setUTCFullYear(t[0],t[1],t[2]),r.setUTCHours(t[3],t[4],t[5],t[6])):(r.setFullYear(t[0],t[1],t[2]),r.setHours(t[3],t[4],t[5],t[6])),r._a=o,r}function f(t,e){var n,i,s=[];for(!e&&A&&(e=require("./lang/"+t)),n=0;n<j.length;n++)e[j[n]]=e[j[n]]||L.en[j[n]];for(n=0;12>n;n++)i=F([2e3,n]),s[n]=new RegExp("^"+(e.months[n]||e.months(i,""))+"|^"+(e.monthsShort[n]||e.monthsShort(i,"")).replace(".",""),"i");return e.monthsParse=e.monthsParse||s,L[t]=e,e}function d(t){var e="string"==typeof t&&t||t&&t._lang||null;return e?L[e]||f(e):F}function m(t){return t.match(/\[.*\]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function p(t){var e,n,i=t.match(P);for(e=0,n=i.length;n>e;e++)i[e]=ee[i[e]]?ee[i[e]]:m(i[e]);return function(s){var r="";for(e=0;n>e;e++)r+="function"==typeof i[e].call?i[e].call(s,t):i[e];return r}}function g(t,e){function n(e){return t.lang().longDateFormat[e]||e}for(var i=5;i--&&O.test(e);)e=e.replace(O,n);return X[e]||(X[e]=p(e)),X[e](t)}function v(t){switch(t){case"DDDD":return z;case"YYYY":return I;case"S":case"SS":case"SSS":case"DDD":return H;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return W;case"Z":case"ZZ":return B;case"T":return R;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return U;default:return new RegExp(t.replace("\\",""))}}function y(t,e,n,i){var s,r;switch(t){case"M":case"MM":n[1]=null==e?0:~~e-1;break;case"MMM":case"MMMM":for(s=0;12>s;s++)if(d().monthsParse[s].test(e)){n[1]=s,r=!0;break}r||(n[8]=!1);break;case"D":case"DD":case"DDD":case"DDDD":null!=e&&(n[2]=~~e);break;case"YY":n[0]=~~e+(~~e>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(e);break;case"a":case"A":i.isPm="pm"===(e+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":n[3]=~~e;break;case"m":case"mm":n[4]=~~e;break;case"s":case"ss":n[5]=~~e;break;case"S":case"SS":case"SSS":n[6]=~~(1e3*("0."+e));break;case"Z":case"ZZ":i.isUTC=!0,s=(e+"").match(V),s&&s[1]&&(i.tzh=~~s[1]),s&&s[2]&&(i.tzm=~~s[2]),s&&"+"===s[0]&&(i.tzh=-i.tzh,i.tzm=-i.tzm)}null==e&&(n[8]=!1)}function b(t,e){var n,i,s=[0,0,1,0,0,0,0],r={tzh:0,tzm:0},o=e.match(P);for(n=0;n<o.length;n++)i=(v(o[n]).exec(t)||[])[0],i&&(t=t.slice(t.indexOf(i)+i.length)),ee[o[n]]&&y(o[n],i,s,r);return r.isPm&&s[3]<12&&(s[3]+=12),r.isPm===!1&&12===s[3]&&(s[3]=0),h(s,r.isUTC,r.tzh,r.tzm)}function w(t,e){var n,i,r,o,a,u=t.match(N)||[],c=99;for(r=0;r<e.length;r++)o=b(t,e[r]),i=g(new s(o),e[r]).match(N)||[],a=l(u,i),c>a&&(c=a,n=o);return n}function _(t){var e,n="YYYY-MM-DDT";if(q.exec(t)){for(e=0;4>e;e++)if(J[e][1].exec(t)){n+=J[e][0];break}return B.exec(t)?b(t,n+" Z"):b(t,n)}return new Date(t)}function k(t,e,n,i,s){var r=s.relativeTime[t];return"function"==typeof r?r(e||1,!!n,t,i):r.replace(/%d/i,e||1)}function x(t,e,n){var i=$(Math.abs(t)/1e3),s=$(i/60),r=$(s/60),o=$(r/24),a=$(o/365),u=45>i&&["s",i]||1===s&&["m"]||45>s&&["mm",s]||1===r&&["h"]||22>r&&["hh",r]||1===o&&["d"]||25>=o&&["dd",o]||45>=o&&["M"]||345>o&&["MM",$(o/30)]||1===a&&["y"]||["yy",a];return u[2]=e,u[3]=t>0,u[4]=n,k.apply({},u)}function M(t,e){F.fn[t]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),this):this._d["get"+n+e]()}}function D(t){F.duration.fn[t]=function(){return this._data[t]}}function T(t,e){F.duration.fn["as"+t]=function(){return+this/e}}for(var F,C,S="1.7.2",$=Math.round,L={},E="en",A="undefined"!=typeof module&&module.exports,j="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),Y=/^\/?Date\((\-?\d+)/i,P=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,O=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,N=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,U=/\d\d?/,H=/\d{1,3}/,z=/\d{3}/,I=/\d{1,4}/,W=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,B=/Z|[\+\-]\d\d:?\d\d/i,R=/T/i,q=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Z="YYYY-MM-DDTHH:mm:ssZ",J=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],V=/([\+\-]|\d\d)/gi,G="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Q={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},X={},K="DDD w M D d".split(" "),te="M D H h m s w".split(" "),ee={M:function(){return this.month()+1},MMM:function(t){return e("monthsShort",this.month(),this,t)},MMMM:function(t){return e("months",this.month(),this,t)},D:function(){return this.date()},DDD:function(){var t=new Date(this.year(),this.month(),this.date()),e=new Date(this.year(),0,1);return~~((t-e)/864e5+1.5)},d:function(){return this.day()},dd:function(t){return e("weekdaysMin",this.day(),this,t)},ddd:function(t){return e("weekdaysShort",this.day(),this,t)},dddd:function(t){return e("weekdays",this.day(),this,t)},w:function(){var t=new Date(this.year(),this.month(),this.date()-this.day()+5),e=new Date(t.getFullYear(),0,4);return~~((t-e)/864e5/7+1.5)},YY:function(){return a(this.year()%100,2)},YYYY:function(){return a(this.year(),4)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return a(~~(this.milliseconds()/10),2)},SSS:function(){return a(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+a(~~(t/60),2)+":"+a(~~t%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+a(~~(10*t/6),4)}};K.length;)C=K.pop(),ee[C+"o"]=i(ee[C]);for(;te.length;)C=te.pop(),ee[C+C]=n(ee[C],2);for(ee.DDDD=n(ee.DDD,3),F=function(e,n){if(null===e||""===e)return null;var i,r;return F.isMoment(e)?new s(new Date(+e._d),e._isUTC,e._lang):(n?i=c(n)?w(e,n):b(e,n):(r=Y.exec(e),i=e===t?new Date:r?new Date(+r[1]):e instanceof Date?e:c(e)?h(e):"string"==typeof e?_(e):new Date(e)),new s(i))},F.utc=function(t,e){return c(t)?new s(h(t,!0),!0):("string"!=typeof t||B.exec(t)||(t+=" +0000",e&&(e+=" Z")),F(t,e).utc())},F.unix=function(t){return F(1e3*t)},F.duration=function(t,e){var n,i=F.isDuration(t),s="number"==typeof t,o=i?t._data:s?{}:t;return s&&(e?o[e]=t:o.milliseconds=t),n=new r(o),i&&(n._lang=t._lang),n},F.humanizeDuration=function(t,e,n){return F.duration(t,e===!0?null:e).humanize(e===!0?!0:n)},F.version=S,F.defaultFormat=Z,F.lang=function(t,e){var n;if(!t)return E;if((e||!L[t])&&f(t,e),L[t]){for(n=0;n<j.length;n++)F[j[n]]=L[t][j[n]];F.monthsParse=L[t].monthsParse,E=t}},F.langData=d,F.isMoment=function(t){return t instanceof s},F.isDuration=function(t){return t instanceof r},F.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(t){var e=t%10;return 1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"}}),F.fn=s.prototype={clone:function(){return F(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this._d.toString()},toDate:function(){return this._d},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?null!=this._a[8]?!!this._a[8]:!l(this._a,(this._a[7]?F.utc(this._a):F(this._a)).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(t){return g(this,t?t:F.defaultFormat)},add:function(t,e){var n=e?F.duration(+e,t):F.duration(t);return u(this,n,1),this},subtract:function(t,e){var n=e?F.duration(+e,t):F.duration(t);return u(this,n,-1),this},diff:function(t,e,n){var i,s=this._isUTC?F(t).utc():F(t).local(),r=6e4*(this.zone()-s.zone()),o=this._d-s._d-r,a=this.year()-s.year(),u=this.month()-s.month(),c=this.date()-s.date();return i="months"===e?12*a+u+c/30:"years"===e?a+(u+c/30)/12:"seconds"===e?o/1e3:"minutes"===e?o/6e4:"hours"===e?o/36e5:"days"===e?o/864e5:"weeks"===e?o/6048e5:o,n?i:$(i)},from:function(t,e){return F.duration(this.diff(t)).lang(this._lang).humanize(!e)},fromNow:function(t){return this.from(F(),t)},calendar:function(){var t=this.diff(F().sod(),"days",!0),e=this.lang().calendar,n=e.sameElse,i=-6>t?n:-1>t?e.lastWeek:0>t?e.lastDay:1>t?e.sameDay:2>t?e.nextDay:7>t?e.nextWeek:n;return this.format("function"==typeof i?i.apply(this):i)},isLeapYear:function(){var t=this.year();return t%4===0&&t%100!==0||t%400===0},isDST:function(){return this.zone()<F([this.year()]).zone()||this.zone()<F([this.year(),5]).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==t?e:this.add({d:t-e})},startOf:function(t){switch(t.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(t){return this.startOf(t).add(t.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return F.utc([this.year(),this.month()+1,0]).date()},lang:function(e){return e===t?d(this):(this._lang=e,this)}},C=0;C<G.length;C++)M(G[C].toLowerCase(),G[C]);M("year","FullYear"),F.duration.fn=r.prototype={weeks:function(){return o(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(t){var e=+this,n=this.lang().relativeTime,i=x(e,!t,this.lang()),s=0>=e?n.past:n.future;return t&&(i="function"==typeof s?s(i):s.replace(/%s/i,i)),i},lang:F.fn.lang};for(C in Q)Q.hasOwnProperty(C)&&(T(C,Q[C]),D(C.toLowerCase()));T("Weeks",6048e5),A&&(module.exports=F),"undefined"==typeof ender&&(this.moment=F),"function"==typeof define&&define.amd&&define("moment",[],function(){return F})}.call(this),FacebookWall={},function(){var t={urlRoot:"https://graph.facebook.com",url:function(){return this.urlRoot+"/"+this.id},urlLike:function(){return this.url()+"/likes"},urlComment:function(){return this.url()+"/comments"},sync:function(t,e,n){n.data||(n.data={}),n.data=_.extend(n.data,{access_token:this.session().accessToken});var i=n.success,s=n.error;return n=_.extend(n,{success:function(t,e,n){if(e.error){if(!s)throw"Unhandled Error: "+JSON.stringify(e);s(t,e,n)}else i&&(t.fetched=!0,i(t,e,n))}}),this._limit&&!n.data.limit&&(n.data.limit=this._limit),n.dataType="jsonp",Backbone.sync(t,e,n)},linkify:function(t){var e=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,n=/(^|[^\/])(www\.[-A-Z0-9+&@#\/%?=~_|!:,.;]+(\b|$))/gi,i=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gi,s=t.replace(e,'<a href="$1" target="_blank">$1</a>');return s=s.replace(n,'$1<a href="http://$2" target="_blank">$2</a>'),s=s.replace(i,'<a href="mailto:$1">$1</a>')},formatDateTime:function(t){var e=moment(t),n=43200,i=3600,s=60,r=moment().unix()-e.unix();if(s>r)return"seconds ago";if(i>r){var o=Math.floor(r/60);return o+(1==o?" minute ago":" minutes ago")}if(n>r){var o=Math.floor(r/60/60);return o+(1==o?" hour ago":" hours ago")}return e.format("ddd MMM Do [at] h:mm a")}};FacebookWall.Collection=Backbone.Collection.extend(_.extend({},t,{paging:{},_defaults:{limit:50},session:function(t){return t&&(this._session=t),this._session},parse:function(t){return this.paging=t.paging||{},t.data},hasNext:function(){return!!this.paging.next},fetchNext:function(){this.paging.next&&Backbone.sync("read",this,{url:this.paging.next,dataType:"jsonp",success:function(t,e){_.each(t.parse(e),function(e){t.add(new t.model(e,{parse:!0}))}),t.trigger("fetchedNext")}})}})),FacebookWall.Model=Backbone.Model.extend(_.extend({},t,{fbPicUrl:function(t,e){var n=e||"large";return"https://graph.facebook.com/"+t+"/picture?type="+n},fbUrl:function(t){return"https://www.facebook.com/"+(t||this.get("id"))},session:function(t){return this.collection?this.collection.session(t):(t&&(this._session=t),this._session)},fromPicUrl:function(t){return this.fbPicUrl(this.get("from").id,t)},fromUrl:function(){return this.fbUrl(this.get("from").id)},picUrl:function(t){return"normal"==t?this.get("picture").replace("_s.jpg","_q.jpg"):"large"==t?this.get("picture").replace("_s.jpg","_n.jpg"):this.get("picture")},fbLike:function(t){return $.ajax({url:this.urlLike(),dataType:"jsonp",data:{method:"unlike"==t.type?"delete":"post",access_token:this.session().accessToken},success:t.success,error:t.error})},fbComment:function(t){return $.ajax({url:this.urlComment(),dataType:"jsonp",data:{method:"delete"==t.type?"delete":"post",access_token:this.session().accessToken,message:t.message},success:t.success,error:t.error})}}))}(),FacebookWall.Post=FacebookWall.Model.extend({parse:function(t){var e=[];t.commentsCount=t.comments?t.comments.count:0,t.comments&&t.comments.data&&(e=_.map(t.comments.data,function(t){return new FacebookWall.Comment(t)})),t.comments=new FacebookWall.Collection(e,{model:FacebookWall.Comment}),t.comments.session(this.session());var n=[];return t.likesCount=t.likes?t.likes.count:0,t.likes&&t.likes.data&&(n=_.map(t.likes.data,function(t){return new FacebookWall.Like(t)})),t.likes=new FacebookWall.Collection(n,{model:FacebookWall.Like}),t.likes.session(this.session()),t},isLiked:function(){var t=this.session().userID;return t?this.get("likes").some(function(e){return t==e.get("id")}):!1},comment:function(t){var e=this;this.fbComment({type:"post",message:t,success:function(n){n.id&&(e.get("comments").push(new FacebookWall.Comment({id:n.id,from:{name:"You",id:e.session().userID},message:t,created_time:new Date})),e.set("commentsCount",e.get("commentsCount")+1))},error:function(){}})},like:function(){var t=this;this.fbLike({type:"like",success:function(){t.set("likesCount",t.get("likesCount")+1),t.get("likes").unshift({name:"You",id:t.session().userID})}})},unlike:function(){var t=this;this.fbLike({type:"unlike",success:function(){var e=t.get("likes"),n=e.filter(function(e){return e.get("id")==t.session().userID});t.set("likesCount",t.get("likesCount")-n.length),e.remove(n)}})}}),FacebookWall.Comment=FacebookWall.Model.extend({name:function(){return this.isMe()?"You":this.get("from").name},isMe:function(){return this.session()&&this.session().userID==this.get("from").id},like:function(){var t=this;this.fbLike({type:"like",success:function(){t.set("user_likes",!0)}})},unlike:function(){var t=this;this.fbLike({type:"unlike",success:function(){t.set("user_likes",!1)}})}}),FacebookWall.Like=FacebookWall.Model.extend({userUrl:function(){return this.fbUrl(this.get("id"))},name:function(){return this.isMe()?"You":this.get("name")},isMe:function(){return this.session()&&this.session().userID==this.get("id")}}),FacebookWall.Feed=FacebookWall.Collection.extend({model:FacebookWall.Post,url:function(){return this.urlRoot+"/"+this.id+"/feed"},initialize:function(t,e){if(!(e&&e.session&&e.session.accessToken&&e.session.userID))throw"FacebookWall.Feed requires a session with accessToken and userID";if(!e||!e.id)throw"FacebookWall.Feed requires an id";return this.id=e.id,this.can_post=e.can_post,this.session(e.session),this._limit=e.limit||this._defaults.limit,this},canPost:function(){return this.can_post}}),FacebookWall.BaseView=Backbone.View.extend({}),FacebookWall.FeedView=FacebookWall.BaseView.extend({className:"fbw-feed",template:_.template('<div class="fbw-loading" style="display:none"></div><div class="fbw-empty" style="display:none">No posts</div><div class="fbw-post-container" style="display:none"><textarea class="fbw-post-textarea" placeholder="Write a post.."></textarea><div class="fbw-post-feed-controls" style="display:none"><button class="btn btn-success post-feed-button">Post</button><button class="btn btn-success disabled posting-feed-button" style="display:none"><img class="fb_spinner"></img>Posting</button></div></div><ul class="fbw-post-list"></ul><div class="fbw-load-container"><button class="fbw-load-segment">Load more posts</button><button class="fbw-loading-segment" disabled="true" style="display:none">Loading posts</button></div>'),events:{"focusin .fbw-post-textarea":"showPostControls","click .fbw-load-segment":"loadNext"},initialize:function(t){return this.feed=t.feed,this.feed.on("reset",this.reset,this),this.feed.on("add",this.add,this),this.feed.on("fetchedNext",this.updateLoadButton,this),this},render:function(){return this.$el.html(this.template(this.feed)),this.feed.each(this.add,this),this.fetched?this.feed.size()<1&&this.showEmpty():this.showLoading(),this.updateLoadButton(),this},reset:function(){this.$el.find(".fbw-loading").hide(),this.$el.find(".fbw-empty").hide(),this.$el.find(".fbw-post-list").empty(),this.feed.size()<1?this.showEmpty():(this.feed.each(this.add,this),this.updateLoadButton())},add:function(t){var e=new FacebookWall.PostView({post:t});this.$el.find(".fbw-post-list").append(e.render().el)},loadNext:function(){this.feed.fetchNext(),this.updateLoadingButton()},updateLoadingButton:function(){this.$el.find(".fbw-loading-segment").show(),this.$el.find(".fbw-load-segment").hide()},updateLoadButton:function(){this.$el.find(".fbw-loading-segment").hide(),this.$el.find(".fbw-load-segment").show();var t=this.$el.find(".fbw-load-container");this.feed.hasNext()?t.show():t.hide()},updatePost:function(){var t=this.$el.find(".fbw-post-container");this.feed.canPost()?t.show():t.hide()},showLoading:function(){this.$el.find(".fbw-loading").show(),this.$el.find(".fbw-loading").html("Loading Posts<br/>"),this.$el.find(".fbw-loading").append((new FacebookWall.Spinner).render().el),this.$el.find(".fbw-empty").hide()},showEmpty:function(){this.$el.find(".fbw-loading").hide(),this.$el.find(".fbw-empty").show()},showPostControls:function(){this.$el.find(".fbw-post-textarea").addClass("focused"),this.$el.find(".fbw-post-feed-controls").show()}}),FacebookWall.PostView=FacebookWall.BaseView.extend({maxLikes:4,tagName:"li",className:"fbw-post",showingLikes:!1,showingComments:!1,template:_.template('<div class="fbw-post-header"><img src="<%= fromPicUrl("square") %>"></img><div class="fbw-post-from"><a href="<%= fromUrl() %>"><%= get("from").name %></a></div><div class="fbw-post-from-details"><%= formatDateTime(get("created_time")) %></div></div><div class="fbw-post-content"><% if (get("message")) {%><%= linkify(get("message")) %><% } %></div><div class="fbw-post-footer"><div class="fbw-post-controls"><div class="fbw-post-controls-views"><% if (get("likesCount") > 0) { %><a href="javascript:void(0)" class="fbw-show-likes fbw-post-link"><%= get("likesCount") %> Like<%if (get("likesCount") != 1) { %>s<%}%></a>  <% } %><% if (get("commentsCount") > 0) { %>&nbsp;<a href="javascript:void(0)" class="fbw-show-comments fbw-post-link"><%= get("commentsCount") %> Comment<%if (get("commentsCount") != 1) { %>s<%}%></a><% } %></div><div style="clear:both;"></div></div><div class="fbw-likes" style="display:none;"></div><ul class="fbw-comments" style="display:none;"></ul><div class="fbw-comments-comment" style="display:none;"><form class="fbw-comments-comment-form"><table border="0" cellpadding="0" cellspacing="0"><tr><td width="100%"><input class="fbw-comments-comment-input"></input></td><td width="1%"><button class="fbw-comments-comment-post" type="submit">Post</button></td></tr></table></form></div></div></div>'),templateLink:_.template('<div class="fbw-post-type-link"><a href="<%= get("link") %>" target="_blank"><img class="fbw-post-link-picture" src="<%= get("picture") %>"></img></a><div class="fbw-post-link-name"><a href="<%= get("link") %>" target="_blank"><%= get("name") %></a></div><div class="fbw-post-link-caption"><%= get("caption") %></div><div class="fbw-post-link-description"><%= get("description") %></div><div style="clear:both;"></div></div>'),templatePhoto:_.template('<div class="fbw-post-type-photo"><img class="fbw-thumbnail" src="<%= picUrl("normal") %>"></img></div>'),events:{"click .fbw-show-comments":"toggleComments","click .fbw-show-likes":"showLikes","click .fbw-post-type-photo img":"loadLargePicture","click .fbw-btn-like-post":"like","click .fbw-btn-comment-post":"showComment","submit .fbw-comments-comment-form":"comment"},initialize:function(t){return this.post=t.post,this.post.get("likes").on("all",this.render,this),this.post.get("comments").on("all",this.render,this),this},render:function(){this.$el.html(this.template(this.post));var t=this.$(".fbw-post-content");return"link"==this.post.get("type")?t.append(this.templateLink(this.post)):"photo"==this.post.get("type")?t.append(this.templatePhoto(this.post)):"video"==this.post.get("type")&&t.append(this.templateLink(this.post)),this.showingLikes&&this.showLikes(),this.showingComments&&this.showComments(),this.renderLikeButton(),this},renderLikeButton:function(){this.$(".fbw-btn-like-post").html(this.post.isLiked()?"Unlike":"Like")},loadLargePicture:function(){var t=this.post.picUrl("large");this.$(".fbw-post-type-photo .fbw-thumbnail").attr("src",t),this.$(".fbw-post-type-photo .fbw-thumbnail").removeClass("fbw-thumbnail")},like:function(){this.post.isLiked()?this.post.unlike():this.post.like()},showLikes:function(){if(this.showingLikes)this.showingLikes=!1,this.$(".fbw-likes").hide();else{this.showingLikes=!0;var t=this.post.get("likesCount"),e=this.post.get("likes").models,n=this.post.get("likes").length;if(1>n)return;for(var i=this.$(".fbw-likes"),s="",r=0;n>r&&r<this.maxLikes;r++)s+='<a href="'+e[r].fbUrl()+'">'+e[r].name()+"</a>",r==n-2&&n==t?s+=" and ":n-1>r&&(s+=", ");if(t>this.maxLikes){var o=t-n;s+=1==o?" and 1 other person likes this":", and "+o+" other people like this"}else s+=1!=e.length||e[0].isMe()?" like this":" likes this";i.html(s),i.show()}},showComment:function(){this.showingComments||this.showComments(),this.$(".fbw-comments-comment-input").focus()},toggleComments:function(){this.showingComments?this.hideComments():this.showComments()},showComments:function(){this.showingComments=!0,this.$(".fbw-comments").empty(),this.$(".fbw-comments").show(),this.post.get("comments").each(this.addComment,this),this.$(".fbw-comments-comment").show(),this.$(".fbw-comments-comment-post").removeAttr("disabled")},hideComments:function(){this.showingComments=!1,this.$(".fbw-comments").hide(),this.$(".fbw-comments-comment").hide()},addComment:function(t){var e=new FacebookWall.CommentView({comment:t});this.$(".fbw-comments").append(e.render().el)},comment:function(t){t.preventDefault();try{var e=this.$(".fbw-comments-comment-input").val();e&&!/^\s*$/.test(e)&&(this.$(".fbw-comments-comment-post").attr("disabled",!0),this.post.comment(e))}catch(n){console.log(n)}return!1}}),FacebookWall.CommentView=FacebookWall.BaseView.extend({tagName:"li",template:_.template('<img src="<%= fromPicUrl("square") %>"></img><div class="fbw-comment-from"><a href="<%= fromUrl() %>"><%= name() %></a></div><div class="fbw-comment-content"><%= get("message") %></div> <div class="fbw-comment-controls"><span class="fbw-comment-time"><%= formatDateTime(get("created_time")) %></span> </div>'),events:{"click .fbw-comment-like":"like","click .fbw-comment-unlike":"unlike"},initialize:function(t){return this.comment=t.comment,this.comment.on("change",this.render,this),this},render:function(){return this.$el.html(this.template(this.comment)),this},like:function(){this.comment.like()},unlike:function(){this.comment.unlike()}}),FacebookWall.Spinner=Backbone.View.extend({className:"fbw-spinner ",render:function(){return this.$el.html('<div class="fbw-bar1"></div><div class="fbw-bar2"></div><div class="fbw-bar3"></div><div class="fbw-bar4"></div><div class="fbw-bar5"></div><div class="fbw-bar6"></div><div class="fbw-bar7"></div><div class="fbw-bar8"></div><div class="fbw-bar9"></div><div class="fbw-bar10"></div><div class="fbw-bar11"></div><div class="fbw-bar12"></div>'),this}});